<div class="container">
  <div class="process-list-card">
    <header class="list-header">
      <h2>Processos em Análise</h2>
      <p>Acompanhe e gerencie os processos enviados para análise.</p>
    </header>

    <div class="list-toolbar">
      <mat-form-field class="search-bar">
        <mat-label>Buscar por número do processo...</mat-label>
        <input matInput type="text" [value]="searchTerm()" (input)="onSearchTermChange($event)" [disabled]="isLoading()">
      </mat-form-field>
      <button mat-icon-button (click)="refreshProcesses()" [disabled]="isLoading()">
        <mat-icon>refresh</mat-icon>
      </button>
    </div>

    @if (isLoading()) {
      <div class="loading-state">
        <mat-progress-spinner mode="indeterminate" diameter="50"></mat-progress-spinner>
        <p>Carregando processos...</p>
      </div>
    } @else {
      @if (filteredProcesses().length > 0) {
        <mat-list>
          @for (process of paginatedProcesses(); track process.id) {
            <mat-list-item>
              <mat-icon matListItemIcon>assignment</mat-icon>
              <div matListItemTitle>Processo: {{ process.id }}</div>
              <div matListItemMeta>
                <button mat-icon-button (click)="viewDetails(process.id)" aria-label="Ver detalhes do processo">
                  <mat-icon>visibility</mat-icon>
                </button>
                <button mat-icon-button color="warn" (click)="deleteProcess(process.id)" aria-label="Apagar processo">
                  <mat-icon>delete</mat-icon>
                </button>
              </div>
            </mat-list-item>
          }
        </mat-list>

        <mat-paginator
          [length]="paginatorConfig().length"
          [pageSize]="paginatorConfig().pageSize"
          [pageIndex]="paginatorConfig().pageIndex"
          (page)="handlePageEvent($event)"
          aria-label="Select page">
        </mat-paginator>

      } @else {
        <div class="empty-state">
          <mat-icon class="empty-icon">search_off</mat-icon>
          <h3>Nenhum processo encontrado</h3>
          @if (searchTerm()) {
            <p>Nenhum processo corresponde à busca "{{ searchTerm() }}".</p>
          } @else {
            <p>Quando um novo processo for enviado, ele aparecerá aqui.</p>
          }
        </div>
      }
    }
  </div>
</div>
